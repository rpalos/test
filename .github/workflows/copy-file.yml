name: 'Copy File if Different'
on:
  push:
    branches:
      - main
jobs:
  check-and-copy:
    runs-on: ubuntu-latest
    steps:
      - name: 'Checkout main branch'
        uses: actions/checkout@v2
        with:
          ref: main

      - name: 'Checkout main-test branch'
        uses: actions/checkout@v2
        with:
          ref: main-test
          path: main-test

      - name: 'Compare files'
        id: compare
        run: |
          if ! cmp -s path/to/test-novedades.txt main-test/path/to/test-novedades2.txt; then
            echo "Files are different"
            echo "copy=true" >> $GITHUB_ENV
          else
            echo "Files are the same"
            echo "copy=false" >> $GITHUB_ENV
          fi
      - name: 'Copy file if different'
        if: env.copy == 'true'
        run: |
          ls
          cp test-novedades main-test/test-novedades2
          echo "File copied to main-test branch"

      - name: 'Commit and push changes'
        if: env.copy == 'true'
        run: |
          cd main-test
          git config --local user.email rpalos@scalperscompany.com
          git config --local user.name Rafael Palos
          git add path/to/test-novedades.txt
          git commit -m "Update file from main branch"
          git push origin main-test

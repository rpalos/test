name: 'Copy File if Different'
on:
  push:
    branches:
      - main
jobs:
  check-and-copy:
    runs-on: ubuntu-latest
    steps:
      - name: 'Checkout main branch'
        uses: actions/checkout@v2
        with:
          ref: main

      - name: 'Checkout main-test branch'
        uses: actions/checkout@v2
        with:
          ref: main-test
          path: main-test

      - name: 'Compare files'
        id: compare
        run: |
          if ! cmp -s path/to/templates/collection.novedades-hombre-D2022.json main-test/path/to/templates/collection.novedades-hombre-D2022.json; then
            echo "Files are different"
            echo "copy=true" >> $GITHUB_ENV
          else
            echo "Files are the same"
            echo "copy=false" >> $GITHUB_ENV
          fi
      - name: 'Copy file if different'
        if: env.copy == 'true'
        run: |
          cp templates/collection.novedades-hombre-D2022.json main-test/templates/collection.novedades-hombre-D2022.json
          echo "File copied to main-test branch"
      - name: 'Config Git'
        if: env.copy == 'true'
        run: |
          git branch
          git config --local user.email rpalos@scalperscompany.com
          git config --local user.name Rafael Palos
          git config --local user.password .Bormujos2024
          # git rm --cached main-test
          git init
          git add templates/collection.novedades-hombre-D2022.json
          git status
          git commit -m "Update file from main branch"
          git push
      - name: 'Checkout main-test branch'
        uses: actions/checkout@v2
        with:
          ref: main-test

